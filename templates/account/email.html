{% load static %}
{% load widget_tweaks %}
<!DOCTYPE html>
<html lang="en" dir="rtl" >
	
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
	<head>

		<meta charset="utf-8">
		<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
		
		<!-- Favicon -->
		<link rel="icon" href="{% static 'dashboard/assets/img/brand/favicon.ico' %}" type="image/x-icon"/>

		<!-- Title -->
		<title>ویرایش ایمیل</title>

		<!-- Bootstrap css-->
		<link href="{% static 'dashboard/assets/plugins/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet"/>

		<!-- Icons css-->
		<link href="{% static 'dashboard/assets/plugins/web-fonts/icons.css' %}" rel="stylesheet"/>
		<link href="{% static 'dashboard/assets/plugins/web-fonts/font-awesome/font-awesome.min.css' %}" rel="stylesheet">
		<link href="{% static 'dashboard/assets/plugins/web-fonts/plugin.css' %}" rel="stylesheet"/>

		<!-- Style css-->
		<link href="{% static 'dashboard/assets/css-rtl/style/style.css' %}" rel="stylesheet">
		<link href="{% static 'dashboard/assets/css-rtl/skins.css' %}" rel="stylesheet">
		<link href="{% static 'dashboard/assets/css-rtl/dark-style.css' %}" rel="stylesheet">
		<link href="{% static 'dashboard/assets/css-rtl/colors/default.css' %}" rel="stylesheet">

		<!-- custom style -->
		<link href="{% static 'dashboard/assets/css-rtl/style/custom.css' %}" rel="stylesheet"/>
		
		<!-- Color css-->
		<link id="theme" rel="stylesheet" type="text/css" media="all" href="{% static 'dashboard/assets/css-rtl/colors/color.css' %}">

	</head>

	<body class="main-body leftmenu">

		<!-- Loader -->
		<div id="global-loader">
			<img src="{% static 'dashboard/assets/img/loader.svg' %}" class="loader-img" alt="Loader">
		</div>
		<!-- End Loader -->

		
		<!-- Page -->
		<div class="page main-signin-wrapper">

			<!-- Row -->
			<div class="row signpages text-center">
				<div class="col-md-12">
					<div class="card">
						<div class="row row-sm">
                            {% include 'account/_messages.html' %}
                            <h1>ایمیل‌ها</h1>
                            {% if user.emailaddress_set.all %}
                                <p>ایمیل‌های ثبت شده برای حساب شما</p>

                                <form action="{% url 'account_email' %}" class="email_list" method="post">
                                {% csrf_token %}
                                <fieldset class="blockLabels">

                                {% for emailaddress in user.emailaddress_set.all %}
                                <div class="ctrlHolder">
                                    <label for="email_radio_{{forloop.counter}}" class="{% if emailaddress.primary %}primary_email{%endif%}">

                                    <input id="email_radio_{{forloop.counter}}" type="radio" name="email" {% if emailaddress.primary or user.emailaddress_set.count == 1 %}checked="checked"{%endif %} value="{{emailaddress.email}}"/>

                                {{ emailaddress.email }}
                                    {% if emailaddress.verified %}
                                    <span class="text-success">ایمیل تایید شده</span>
                                    {% else %}
                                    <span class="text-danger">ایمیل تایید نشده</span>
                                    {% endif %}
                                    {% if emailaddress.primary %}<span class="text-primary">اصلی</span>{% endif %}
                                </label>
                                </div>
                                {% endfor %}

                                <div class="buttonHolder">
                                    <button class="btn btn-success" type="submit" name="action_primary" >در نظر گرفتن به عنوان ایمیل اصلی</button>
                                    <button class="btn btn-primary" type="submit" name="action_send" >درخواست ارسال ایمیل تاییدیه</button>
                                    <button class="btn btn-danger" type="submit" name="action_remove" >حذف ایمیل</button>
                                </div>

                                </fieldset>
                                </form>

                            {% else %}
                                <p><strong>هشدار</strong> شما در حال حاضر هیچ ایمیلی برای حساب خود ثبت نکرده‌اید. برای دریافت نوتیفیکیشن‌ها، درخواست فراموشی رمز عبور و ... شما نیاز به ایمیل دارید، پس همین حالا ایمیل خود را ثبت نمایید.</p>
                                
                            {% endif %}

                            {% if can_add_email %}
                                <h2>اضافه کردن ایمیل جدید</h2>

                                <form method="post" action="{% url 'account_email' %}" class="add_email">
                                    {% csrf_token %}
                                    {{ form.as_p }}
                                    <button name="action_add" type="submit">اضافه کردن</button>
                                </form>
                            {% endif %}
						</div>
					</div>
				</div>
			</div>
			<!-- End Row -->

		</div>
		<!-- End Page -->

        <script type="text/javascript">
            (function() {
              var message = "آیا واقعا میخواهید این ایمیل را حذف کنید؟";
              var actions = document.getElementsByName('action_remove');
              if (actions.length) {
                actions[0].addEventListener("click", function(e) {
                  if (! confirm(message)) {
                    e.preventDefault();
                  }
                });
              }
            })();
            </script>

		<!-- Jquery js-->
		<script src="{% static 'dashboard/assets/plugins/jquery/jquery.min.js' %}"></script>

		<!-- Bootstrap js-->
		<script src="{% static 'dashboard/assets/plugins/bootstrap/js/jquery-3.5.1.slim.min.js' %}"></script>
		<script src="{% static 'dashboard/assets/plugins/bootstrap/js/popper.min.js' %}"></script>
		<script src="{% static 'dashboard/assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>

		<!-- Select2 js-->
		<script src="{% static 'dashboard/assets/plugins/select2/js/select2.min.js' %}"></script>

		
		<!-- Custom js -->
		<script src="{% static 'dashboard/assets/js/custom.js' %}"></script>
	</body>

</html>